<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  
  
  <link rel="shortcut icon" href="../img/favicon.ico">
  <title>Pipelines - Quevedo Documentation</title>
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700" />

  <link rel="stylesheet" href="../css/theme.css" />
  <link rel="stylesheet" href="../css/theme_extra.css" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github.min.css" />
  <link href="//use.fontawesome.com/releases/v5.8.1/css/all.css" rel="stylesheet" />
  <link href="//use.fontawesome.com/releases/v5.8.1/css/v4-shims.css" rel="stylesheet" />
  <link href="../css/mkapi-common.css" rel="stylesheet" />
  <link href="../css/mkapi-readthedocs.css" rel="stylesheet" />
  <link href="../css/version-select.css" rel="stylesheet" />
  
  <script>
    // Current page data
    var mkdocs_page_name = "Pipelines";
    var mkdocs_page_input_path = "pipes.md";
    var mkdocs_page_url = null;
  </script>
  
  <script src="../js/jquery-2.1.1.min.js" defer></script>
  <script src="../js/modernizr-2.8.3.min.js" defer></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
  <script>hljs.initHighlightingOnLoad();</script> 
  
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
        <a href=".." class="icon icon-home"> Quevedo Documentation</a>
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="..">Home</a>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">Concepts</span></p>
                <ul class="current">
                    <li class="toctree-l1"><a class="reference internal" href="../concepts/">Quevedo Datasets</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../nets/">Neural networks</a>
                    </li>
                    <li class="toctree-l1 current"><a class="reference internal current" href="./">Pipelines</a>
    <ul class="current">
    <li class="toctree-l2"><a class="reference internal" href="#pipeline-configuration">Pipeline configuration</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#common-options">Common options</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#logogram-recognizer">Logogram recognizer</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#sequence-classifier">Sequence classifier</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#branching-classifier">Branching classifier</a>
    </li>
    </ul>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">Admin Guides</span></p>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../config/">Dataset Configuration</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../cli/">Command Line Interface</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../web/">Web Interface</a>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">User Guides</span></p>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../guide/">Building a Dataset</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../web_use/">Using the web interface</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../dev/">Quevedo as a library</a>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">API</span></p>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../api/">Reference</a>
                    </li>
                </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="..">Quevedo Documentation</a>
      </nav>

      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="..">Docs</a> &raquo;</li>
    
      
        
          <li>Concepts &raquo;</li>
        
      
    
    <li>Pipelines</li>
    <li class="wy-breadcrumbs-aside">
      
    </li>
  </ul>
  
  <hr/>
</div>
          <div role="main">
            <div class="section">
              
                <h1 id="pipelines">Pipelines<a class="headerlink" href="#pipelines" title="Permanent link">&para;</a></h1>
<div class="admonition note">
<p class="admonition-title">New in v1.2</p>
<p>Pipelines are new in version 1.2.</p>
</div>
<p>Quevedo allows you to train different <a href="../nets/">neural networks</a> to recognize
different objects and features. These networks can then be composed into
a pipeline to build an expert system, capable of performing a bigger task than
each of the networks by themselves.</p>
<p>For example, a detection network can first locate the graphemes within
a logogram, and then specialist networks used to classify each of the graphemes.</p>
<p>When using quevedo in the command line, you can choose the pipeline to test or
execute with the <code>-P</code> flag (equivalent to the <code>-N</code> flag for networks). In the
web interface, the pipelines are available along the trained networks and user
functions for the user to run and visualize.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Quevedo pipelines can be used to create expert systems for processing
visually complex images. One such example, for the case of SignWriting, is
described in the article <a href="https://eprints.ucm.es/id/eprint/69235/">Automatic SignWriting Recognition</a>.</p>
</div>
<h2 id="pipeline-configuration">Pipeline configuration<a class="headerlink" href="#pipeline-configuration" title="Permanent link">&para;</a></h2>
<p>Pipelines are added to the <code>config.toml</code> file of the dataset. Each entry is the
name of the pipeline, added to the "pipeline" table. There are a number of types
of pipelines that can be used, each with their own configuration, but there are
some common options.</p>
<h3 id="common-options">Common options<a class="headerlink" href="#common-options" title="Permanent link">&para;</a></h3>
<p>Options for the pipelines often take as value the name of a neural network. Most
of the time, instead of a neural network, the name of a pipeline can be used.
Quevedo will search the configuration file for pipelines or networks with
a matching name, so neither "network" nor "pipeline" need to be prepended.</p>
<p>If a "subsets" key is given to a pipeline, you will be able to use the
<a href="../cli/#test"><code>test</code></a> command to evaluate the performance of the pipeline on
those sets. Testing pipelines follows the same rules as for networks, and uses
the configured test folds. Training full pipelines is not yet supported, please
train the networks individually.</p>
<p>Pipelines can also use the <code>extend</code> keyword to inherit configuration from
another pipeline, making it easy to set the same subsets to test all pipelines,
or share some of the options. This extension is recursive, so chains of
pipeline configurations can be used.</p>
<h2 id="logogram-recognizer">Logogram recognizer<a class="headerlink" href="#logogram-recognizer" title="Permanent link">&para;</a></h2>
<p>A logogram recognizer pipeline has two steps. The first step uses a <a href="../nets/#detector">detector
network</a> to find graphemes in an image. An optional second
step uses a <a href="../nets/#classifier">classifier network</a> or another pipeline to then
extract the tags for each of the graphemes. The end result is the detected
logogram but with the graphemes augmented by the classifier.</p>
<pre><code class="language-toml"># Example logogram pipeline. It uses a network named &quot;detector&quot; to find the
# graphemes, and then further classifies them with a network named &quot;classifier&quot;
[pipeline.logograms]
detect = &quot;detector&quot;
classify = &quot;classifier&quot;
</code></pre>
<h2 id="sequence-classifier">Sequence classifier<a class="headerlink" href="#sequence-classifier" title="Permanent link">&para;</a></h2>
<p>A sequence classifier uses many classifier networks or pipelines to iteratively
augment the annotation of a grapheme. It has one single option, <code>sequence</code>,
which is a list of the sub-systems to run.</p>
<p>Additionally to networks and pipelines, the steps in the sequence can be lambda
functions to run on the grapheme, or longer functions defined in a user script.
For this, place the script in the <code>scripts</code> directory, and use as step
<code>script_name.py:function_name</code>.</p>
<pre><code class="language-toml"># Example sequence pipeline. It uses a network called &quot;classifier1&quot; to find
# a first possible set of tags for the grapheme. Then, a function
# &quot;error_correction&quot; in the &quot;functions.py&quot; user script fixes some common errors.
# A second network called &quot;classifier2&quot; makes use of the fixed grapheme to get
# a better prediction.
[pipeline.sequence]
extend = &quot;defaults&quot;
sequence = [
    &quot;classifier1&quot;
    &quot;funtions.py:error_correction&quot;,
    &quot;classifier2&quot;
]
</code></pre>
<h2 id="branching-classifier">Branching classifier<a class="headerlink" href="#branching-classifier" title="Permanent link">&para;</a></h2>
<p>A branching pipeline can serve to classify graphemes using different networks or
pipelines according to some of the grapheme characteristics. A <code>criterion</code>
option sets the value to use to choose the branch, and then the other options
are the networks or sub-pipelines for each branch. The criterion can be the name
of a tag, or a lambda function to call on the grapheme.</p>
<pre><code class="language-toml"># Example branching pipeline
[pipeline.branching]
criterion = &quot;lambda g: g.tags.get('TAG1')&quot;
criterion = &quot;TAG1&quot; # equivalent to the previous one
value1 = &quot;classifier_for_value1s&quot;
value2 = &quot;classifier_for_value2s&quot;
</code></pre>
              
            </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../config/" class="btn btn-neutral float-right" title="Dataset Configuration">Next <span class="icon icon-circle-arrow-right"></span></a>
      
      
        <a href="../nets/" class="btn btn-neutral" title="Neural networks"><span class="icon icon-circle-arrow-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
      
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="versions">
    <span class="rst-current-version" data-toggle="rst-current-version">
      
          <a href="https://github.com/agarsev/quevedo" class="fa fa-github" style="float: left; color: #fcfcfc"> GitHub</a>
      
      
        <span><a href="../nets/" style="color: #fcfcfc;">&laquo; Previous</a></span>
      
      
        <span style="margin-left: 15px"><a href="../config/" style="color: #fcfcfc">Next &raquo;</a></span>
      
    </span>
</div>
    <script>var base_url = '..';</script>
    <script src="../js/theme.js" defer></script>
      <script src="../js/mkapi.js" defer></script>
      <script src="../search/main.js" defer></script>
      <script src="../js/version-select.js" defer></script>
    <script defer>
        window.onload = function () {
            SphinxRtdTheme.Navigation.enable(true);
        };
    </script>

</body>
</html>
